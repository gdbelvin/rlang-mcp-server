FROM node:20-slim

WORKDIR /app

# Copy all source files first
COPY package*.json tsconfig.json ./
COPY src/ ./src/

# Install dependencies and build
RUN npm install --ignore-scripts && npm run build

# Create directories for R Markdown files
RUN mkdir -p rmd/output

# Expose any necessary ports (if needed)
# EXPOSE 8080

# Set the entrypoint to run the MCP server
CMD ["node", "build/index.js"]
